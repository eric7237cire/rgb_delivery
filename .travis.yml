matrix:
  include:
    - language: rust
      cache: cargo

      before_install:
        - cd rgb-solver

      # https://github.com/rustwasm/wasm-pack-template/blob/master/.travis.yml
      before_script:

        #- rustup target add wasm32-unknown-unknown
        #- curl https://rustwasm.github.io/wasm-pack/installer/init.sh -sSf | sh -s -- -f

      script:
        #- cargo build --verbose --all
        - cargo test --target x86_64-unknown-linux-gnu --lib --verbose --all

        # - wasm-pack build

# need to publish an npm module
    - language: node_js
#

#        - cd grid-editor
#
      node_js:
        - "9"
      dist: trusty
#      sudo: required
#      branches:
#        only:
#        - master
#      before_script:
#        - npm install -g @angular/cli
      script:
        - cd web_worker
        - npm install
        - ./node_modules/.bin/webpack
        - cp ./dist/* ../grid-editor/src/assets
        - cp ./worker/py /Y "%WEB_WORKER_BUILD_DIR%worker\interface_types.ts" "%GRID_EDITOR_BUILD_DIR%src\app\typings\worker.ts
#        - ng lint
#        - ng build --prod --base-href https://eric7237cire.github.io/rgb_delivery/